
map.on('load', function () {

 
var geojson = {
    "type": "FeatureCollection",
    "features": [
        {
            "type": "Feature",
            "properties": {
                "message": "Lisboa",
                "description": "<strong>**Make it Mount Pleasant</strong><p><a href=\"http://www.mtpleasantdc.com/makeitmtpleasant\" target=\"_blank\" title=\"Opens in a new window\">Make it Mount Pleasant</a> is a handmade and vintage market and afternoon of live entertainment and kids activities. 12:00-6:00 p.m.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                    -9.160,
                    38.744
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "message": "Madrid",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                   -3.704,
                   40.478,
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "message": "Barcelona",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                   2.141,
                    41.393
                ]
            }
        },
         {
            "type": "Feature",
            "properties": {
                "message": "Marseille",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                   5.345,
                   43.300,
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "message": "London",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                   -0.087,
                   51.489,
                ]
            }
        },
         {
            "type": "Feature",
            "properties": {
                "message": "Paris",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                   2.347,
                   48.859,
                ]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "message": "Paris-Gharlis",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                   2.374,
                   48.845,
                ]
            }
        },
         {
            "type": "Feature",
            "properties": {
                "message": "Brussels",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                   4.369,
                   50.843 
                ]
            }
        },

        {
            "type": "Feature",
            "properties": {
                "message": "Berlin",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                   13.424,
                   52.507 
                ]
            }
        }, 

         {
            "type": "Feature",
            "properties": {
                "message": "Lyon",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                   4.835,45.758
                ]
            }
        }, 

        {
            "type": "Feature",
            "properties": {
                "message": "Milan",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                  9.129,45.402
                ]
            }
        }, 

        {
            "type": "Feature",
            "properties": {
                "message": "Rome",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                 12.470,41.802
                ]
            }
        }, 

        {
            "type": "Feature",
            "properties": {
                "message": "Athenas",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                 23.734,37.987
                ]
            }
        }, 


        {
            "type": "Feature",
            "properties": {
                "message": "Nice",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [20, 20],
                "nameIcon": "botones_avignon-off.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                 7.253,43.703
                ]
            }
        }, 


        {
            "type": "Feature",
            "properties": {
                "message": "Avignon",
                "description": "<strong>Capital Pride Parade</strong><p>The annual <a href=\"http://www.capitalpride.org/parade\" target=\"_blank\" title=\"Opens in a new window\">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>",
                "iconSize": [60, 60],
                "nameIcon": "pin.png"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [
                 4.805,43.942
                ]
            }
        }

        

        
    ],

};




 



geojson.features.forEach(function(marker) {

    // create a DOM element for the marker
    var el = document.createElement('div');

    el.className = 'marker';
    el.style.backgroundImage = 'url(./images/pines/' + marker.properties.nameIcon + ')';
    el.style.backgroundSize = "100% 100%";
    el.style.width = marker.properties.iconSize[0] + 'px';
    el.style.height = marker.properties.iconSize[1] + 'px';

    
    el.addEventListener('click', function() {
        //window.alert(marker.properties.message);

        $("#info").mCustomScrollbar("destroy");
   
            // Comprobamos que este oculto el siderBar para mostrarlo 
            if ( $(".siderbar").css('display') == 'none' ){
                 $( ".siderbar" ).toggle( "slide", {direction: 'right'}, function(){ });
                 $( ".open_info_btn" ).hide();
             }


        // Cacheing HTML elements
        var project = document.querySelector('#info');
        project.style.opacity = 0;

        
        setTimeout(function(){ 
           // Agregamos las propiedades de descripción con innerHTML
            project.style.opacity = 1;


            $.ajax({url: "", 
            success: function(result){
                 
                console.log("Succes!!!")
                $("#info").mCustomScrollbar({theme:"minimal",
                    advanced:{
                        updateOnContentResize: true
                    }
                });

                $("#info").mCustomScrollbar("update");


            
            }});
             
        },400);



    });

   

    // add marker to map
    new mapboxgl.Marker(el, {offset: [-marker.properties.iconSize[0] / 2, -marker.properties.iconSize[1] / 2]})
        .setLngLat(marker.geometry.coordinates)
        .addTo(map);
});




});



 



 



 